#########################################################################
#
# - Read test_add_instructions_tv.txt before for format description and the
#   steps to be followed while adding new test vectors for supported tests
#
# - This file contains Key Generation Positive Test vectors for
#   ELE HSM API Tests.
#   Currently Supports test vectors for following operations:
#   KGEN, CIPHER, MAC, SIGN_VERIFY, HASH, DATA STORAGE
#
#########################################################################


TESTS_START



OPEN_KEY_MGMT_SRV
1234             #Key Management ID, KEY_MGMT_TV_ID to be used by tests



##########################################################################
# Key Generation Tests
##########################################################################


#Positive Case
#Key Generation of AES 256 key
TEST_KGEN_PSA_P001

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         1          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Postive Case
#Key Generation of HMAC 256 key
TEST_KGEN_PSA_P002

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         2          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x1100     # HSM_KEY_TYPE_HMAC
BIT_KEY_SZ        256        # HSM_KEY_SIZE_HMAC_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03800009 # PERMITTED_ALGO_HMAC_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Key Generation of ECC 256 asymmetric key pair
TEST_KGEN_PSA_P003

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         3          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00004000 # HSM_KEY_USAGE_DERIVE
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Key Generation of RSA 2048 asymmetric key pair
TEST_KGEN_PSA_P004

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         4          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          256        # Public Key Out Size
KEY_TYPE          0x7001     # HSM_KEY_TYPE_RSA
BIT_KEY_SZ        2048       # HSM_KEY_SIZE_RSA_2048
FLAGS             0          #
KEY_GROUP         9          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x06000209 # PERMITTED_ALGO_RSA_PKCS1_V15_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Key Generation of RSA 3072 asymmetric key pair
TEST_KGEN_PSA_P005

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         5          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          384        # Public Key Out Size
KEY_TYPE          0x7001     # HSM_KEY_TYPE_RSA
BIT_KEY_SZ        3072       # HSM_KEY_SIZE_RSA_3072
FLAGS             0          #
KEY_GROUP         4          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x0600020A # PERMITTED_ALGO_RSA_PKCS1_V15_SHA384
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Key Generation of RSA 4096 asymmetric key pair
TEST_KGEN_PSA_P006

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         6          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          512        # Public Key Out Size
KEY_TYPE          0x7001     # HSM_KEY_TYPE_RSA
BIT_KEY_SZ        4096       # HSM_KEY_SIZE_RSA_4096
FLAGS             0          #
KEY_GROUP         5          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x0600020B # PERMITTED_ALGO_RSA_PKCS1_V15_SHA512
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#########################################################################
# Persistent Key KGEN Tests
##########################################################################


#Load Persistent Key Info (KEY_TV_ID, KEY_IDENTIFIER) from persistent key
#details stored previously
LOAD_PERSIST_KEY_INFO


#Positive Case
#Test Generate Key API for Persistent Key Generation and Usage in getting
#Key Attributes if already generated
TEST_KGEN_PSA_P007

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         7          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         6          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Test Generate Key API for Persistent Key Generation and Usage in getting
#Key Attributes if already generated
TEST_KGEN_PSA_P008

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         8          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x1100     # HSM_KEY_TYPE_HMAC
BIT_KEY_SZ        256        # HSM_KEY_SIZE_HMAC_256
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         6          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03800009 # PERMITTED_ALGO_HMAC_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Test Generate Key API for Persistent Key Generation and Usage in getting
#Key Attributes if already generated
TEST_KGEN_PSA_P009

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         9          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         6          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00004000 # HSM_KEY_USAGE_DERIVE
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END


#########################################################################


##########################################################################
# Key Generation - Input Key Identifier value (non-zero)
##########################################################################


#Positive Case
#Test Generate Key API for Persistent Key Generation and Usage in getting
#Key Attributes if already generated, with valid Key Identifier input value
TEST_KGEN_PSA_P010

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         10         # Key TV ID to use the key later
KEY_ID            0x00000001 # Key Identifier
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         6          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Test Generate Key API for Persistent Key Generation and Usage in getting
#Key Attributes if already generated, with valid Key Identifier input value
TEST_KGEN_PSA_P011

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         11         # Key TV ID to use the key later
KEY_ID            0x3FFFFFFA # Key Identifier
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x1100     # HSM_KEY_TYPE_HMAC
BIT_KEY_SZ        256        # HSM_KEY_SIZE_HMAC_256
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         6          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000800 # HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03800009 # PERMITTED_ALGO_HMAC_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Test Generate Key API for Persistent Key Generation and Usage in getting
#Key Attributes if already generated, with valid Key Identifier input value
TEST_KGEN_PSA_P012

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         12         # Key TV ID to use the key later
KEY_ID            0x20000000 # Key Identifier
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         6          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00004000 # HSM_KEY_USAGE_DERIVE
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Key Generation of AES 256 key, with Valid Key Identifier input value in range
TEST_KGEN_PSA_P013

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         13         # Key TV ID to use the key later
KEY_ID            0x50000000 # Key Identifier
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Key Generation of HMAC 256 key, with Valid Key Identifier input value in range
TEST_KGEN_PSA_P014

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         14         # Key TV ID to use the key later
KEY_ID            0x60000000 # Key Identifier
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x1100     # HSM_KEY_TYPE_HMAC
BIT_KEY_SZ        256        # HSM_KEY_SIZE_HMAC_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03800009 # PERMITTED_ALGO_HMAC_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
#Key Generation of ECC 256 key, with Valid Key Identifier input value in range
TEST_KGEN_PSA_P015

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         15         # Key TV ID to use the key later
KEY_ID            0x7FFFFFF0 # Key Identifier
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00004000 # HSM_KEY_USAGE_DERIVE
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



##########################################################################



CLOSE_KEY_MGMT_SRV
1234     #KEY_MGMT_TV_ID



TESTS_END
