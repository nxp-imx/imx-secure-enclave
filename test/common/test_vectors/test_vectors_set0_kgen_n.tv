#########################################################################
#
# - Read test_add_instructions_tv.txt before for format description and the
#   steps to be followed while adding new test vectors for supported tests
#
# - This file contains Key Generation Negative Test vectors for
#   ELE HSM API Tests.
#   Currently Supports test vectors for following operations:
#   KGEN, CIPHER, MAC, SIGN_VERIFY, HASH, DATA STORAGE
#
#########################################################################



TESTS_START



OPEN_KEY_MGMT_SRV
1234             #Key Management ID, KEY_MGMT_TV_ID to be used by tests



##########################################################################
# Key Generation Tests
##########################################################################


#Negative Case
#Incorrect Key Lifetime value
TEST_KGEN_PSA_N001

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         1          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000012 # Incorrect Value
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00004300 # HSM_KEY_USAGE_DERIVE | HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case
#Incompatible Key Usage flags set, for HSM_KEY_TYPE_AES_256
TEST_KGEN_PSA_N002

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         2          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case
#Incompatible Key Usage flags set, for AES 128 key
TEST_KGEN_PSA_N003

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         3          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        128        # HSM_KEY_SIZE_AES_128
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case
#Incorrect Permitted Algo
TEST_KGEN_PSA_N004

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         4          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x01108888 # Incorrect Value
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case
#Invalid Key Type
TEST_KGEN_PSA_N005

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         5          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x99       # Non-Existent, Incorrect Key Type
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_KGEN_END



#Negative Case
#Incorrect Key Group, for Symmetric Key
TEST_KGEN_PSA_N006

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         6          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1024       # Key Group OUT OF RANGE [0-1023]
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case
#Incorrect Key Usage, for Asymmetric Key
TEST_KGEN_PSA_N007

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         7          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00009000 # Non-Existent, Incorrect KEY USAGE value
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case
#Key Not Supported
TEST_KGEN_PSA_N008

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         8          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          80         # Public Key Out Size
KEY_TYPE          0x7130     # HSM_KEY_TYPE_ECC_BP_R1
BIT_KEY_SZ        320        # HSM_KEY_SIZE_ECC_BP_R1_320
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x06000608 # PERMITTED_ALGO_ECDSA_SHA224
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_KGEN_END



#Negative Case
#Key Generation of RSA 2048 asymmetric key pair
#Invalid Out size, less than required
TEST_KGEN_PSA_N009

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         9          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          255        # Public Key Out Size
KEY_TYPE          0x7001     # HSM_KEY_TYPE_RSA
BIT_KEY_SZ        2048       # HSM_KEY_SIZE_RSA_2048
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x06000209 # PERMITTED_ALGO_RSA_PKCS1_V15_SHA256
EXPECTED_HSM_RESP 0x1D       # HSM_OUT_TOO_SMALL

TEST_KGEN_END



#Negative Case
#Key Generation of RSA 3072 asymmetric key pair
#Invalid Key Lifecycle value
TEST_KGEN_PSA_N010

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         10         # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          384        # Public Key Out Size
KEY_TYPE          0x7001     # HSM_KEY_TYPE_RSA
BIT_KEY_SZ        3072       # HSM_KEY_SIZE_RSA_3072
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0000FFFF # INVALID value
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x0600020A # PERMITTED_ALGO_RSA_PKCS1_V15_SHA384
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case
#Key Generation of RSA 4096 asymmetric key pair
#Invalid Key Usage value
TEST_KGEN_PSA_N011

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         11         # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          512        # Public Key Out Size
KEY_TYPE          0x7001     # HSM_KEY_TYPE_RSA
BIT_KEY_SZ        4096       # HSM_KEY_SIZE_RSA_4096
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00009000 # INVALID value
PERMITTED_ALGO    0x0600020B # PERMITTED_ALGO_RSA_PKCS1_V15_SHA512
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



##########################################################################
# Key Generation - Input Key Identifier value (non-zero)
##########################################################################


#Negative Case
#Out of Range Key ID value for Persistent Key
TEST_KGEN_PSA_N012

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         12         # Key TV ID to use the key later
KEY_ID            0x5555FFFF # Key Identifier out of valid range
OUT_SIZE          56         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        224        # HSM_KEY_SIZE_ECC_NIST_224
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         3          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x06000608 # PERMITTED_ALGO_ECDSA_SHA224
EXPECTED_HSM_RESP 0x0B       # HSM_ID_CONFLICT

TEST_KGEN_END



#Negative Case
#Out of Range Key ID value for Persistent Key
TEST_KGEN_PSA_N013

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         13         # Key TV ID to use the key later
KEY_ID            0x4FFFFFFE # Key Identifier out of valid range
OUT_SIZE          132        # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        521        # HSM_KEY_SIZE_ECC_NIST_521
FLAGS             0x80       # HSM_OP_KEY_GENERATION_FLAGS_STRICT_OPERATION
KEY_GROUP         3          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000101 # HSM_SE_KEY_STORAGE_PERSISTENT
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00001000 # HSM_KEY_USAGE_SIGN_HASH
PERMITTED_ALGO    0x0600060B # PERMITTED_ALGO_ECDSA_SHA512
EXPECTED_HSM_RESP 0x0B       # HSM_ID_CONFLICT

TEST_KGEN_END



#Negative Case
#Out of Range Key ID value for Volatile Key
TEST_KGEN_PSA_N014

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         14         # Key TV ID to use the key later
KEY_ID            0x45000000 # Key Identifier out of valid range
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00004000 # HSM_KEY_USAGE_DERIVE
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x0B       # HSM_ID_CONFLICT

TEST_KGEN_END



#Negative Case
#Out of Range Key ID value for Volatile Key
TEST_KGEN_PSA_N015

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         15         # Key TV ID to use the key later
KEY_ID            0x30000000 # Key Identifier out of valid range
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000400 # HSM_KEY_USAGE_SIGN_MSG
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x0B       # HSM_ID_CONFLICT


TEST_KGEN_END


#########################################################################


##########################################################################



CLOSE_KEY_MGMT_SRV
1234     #KEY_MGMT_TV_ID



TESTS_END
