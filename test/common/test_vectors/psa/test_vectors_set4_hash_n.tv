#########################################################################
#
# - Read test_add_instructions_tv.txt before for format description and the
#   steps to be followed while adding new test vectors for supported tests
#
# - This file contains HASH Negative Test vectors for ELE HSM API Tests.
#   Currently Supports test vectors for following operations:
#   KGEN, CIPHER, MAC, SIGN_VERIFY, HASH, DATA STORAGE
#
#########################################################################



TESTS_START



##########################################################################
# HASH Tests
##########################################################################


#Negative Case
#Test HASH operation for SHA 224 algo
#Incorrect Output Size in input params (greater than required)
TEST_HASH_PSA_N401

HASH_ALGO         0x02000008   #HSM_HASH_ALGO_SHA_224
FLAGS             0x1          #One shot HASH op
CTX_SIZE          0            #Context size
INPUT_CTX         0            #Input Context
INPUT_SIZE        300          #Input Size

INPUT_DATA        300          #Input Data-Input Size, buffer from next line
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0,

OUTPUT_SIZE            29      # Output Size
EXP_CTX_SIZE           0       # Expected Context Size
EXP_OUTPUT_SIZE        28      # Expected Output Size

EXP_OUTPUT_BUF         28      # Expected Output-Buffer Size, input next line
0x55, 0x4D, 0x5E, 0xED, 0x37, 0x31, 0x6F, 0xCA,
0xD7, 0x08, 0x72, 0x54, 0x4E, 0x05, 0x8C, 0xD4,
0xFC, 0x9E, 0x1C, 0x68, 0xE3, 0xDA, 0x18, 0x29,
0x44, 0x39, 0xB4, 0xAA,

EXP_HASH_HSM_RESP      0x00   # HSM_NO_ERROR

TEST_HASH_END



#Negative Case:
#Test HASH operation for SHA 224 algo
#and Incorrect Output Size in input params (less than required)
TEST_HASH_PSA_N402

HASH_ALGO         0x02000008   #HSM_HASH_ALGO_SHA_224
FLAGS             0x1          #One shot HASH op
CTX_SIZE          0            #Context size
INPUT_CTX         0            #Input Context
INPUT_SIZE        300          #Input Size

INPUT_DATA        300          #Input Data-Input Size, buffer from next line
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0, 0x7C, 0xCB, 0x0E, 0xA9,
0xF4, 0x74, 0x7B, 0x8C, 0xCD, 0xA8, 0xA4, 0xF3,
0x6D, 0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20,
0xB2, 0xE1, 0x4C, 0x5C, 0x79, 0xC6, 0xDF, 0x5B,
0x85, 0xF4, 0xFE, 0x7E, 0xD8, 0xDB, 0x7A, 0x26,
0x2B, 0x9D, 0xA7, 0xE0,

OUTPUT_SIZE            27      # Output Size
EXP_CTX_SIZE           0       # Expected Context Size
EXP_OUTPUT_SIZE        28      # Expected Output Size

EXP_OUTPUT_BUF         27      # Expected Output-Buffer Size, input next line
0x55, 0x4D, 0x5E, 0xED, 0x37, 0x31, 0x6F, 0xCA,
0xD7, 0x08, 0x72, 0x54, 0x4E, 0x05, 0x8C, 0xD4,
0xFC, 0x9E, 0x1C, 0x68, 0xE3, 0xDA, 0x18, 0x29,
0x44, 0x39, 0xB4,

EXP_HASH_HSM_RESP      0x1D    # HSM_OUT_TOO_SMALL

TEST_HASH_END



##########################################################################



TESTS_END
