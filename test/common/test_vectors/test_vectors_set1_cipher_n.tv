#########################################################################
#
# - Read test_add_instructions_tv.txt before for format description and the
#   steps to be followed while adding new test vectors for supported tests
#
# - This file contains Cipher Negative Test vectors for ELE HSM API Tests.
#   Currently Supports test vectors for following operations:
#   KGEN, CIPHER, MAC, SIGN_VERIFY, HASH, DATA STORAGE
#
#########################################################################



TESTS_START



OPEN_KEY_MGMT_SRV
1234             #Key Management ID, KEY_MGMT_TV_ID to be used by tests



##########################################################################
# CIPHER Tests Helper: Key Generation Tests
##########################################################################

#KEY GENERATION Tests for generating keys which can be used in CIPHER TESTS


#Positive Case
TEST_KGEN_PSA_P101_CIPHER_N

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         101        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x04404000 # PERMITTED_ALGO_CBC_NO_PADDING
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_P102_CIPHER_N

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         102        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x04404400 # PERMITTED_ALGO_ECB_NO_PADDING
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_P103_CIPHER_N

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         103        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00000200 # HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x04404000 # PERMITTED_ALGO_CBC_NO_PADDING
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_P104_CIPHER_N

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         104        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID to be chosen by FW
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000100 # HSM_SE_KEY_STORAGE_VOLATILE
KEY_LIFECYCLE     0x0        # 0 indicates set to current Device Lifecycle
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



##########################################################################



##########################################################################
# CIPHER tests
##########################################################################

#CIPHER tests using Saved Generated Keys with KEY_TV_ID


#Negative Case:
#Invalid IV size instead of 16 bytes providing 32 bytes
TEST_CIPHER_PSA_N101

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         101        # Key TV ID from KGEN Tests to use the key
IV_SIZE           32         # IV Size provided before IV data

IV_DATA           32         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_CIPHER_END



#Negative Case:
#Invalid Output Size instead of 32 bytes providing 16 bytes
TEST_CIPHER_PSA_N102

KEY_MGMT_TV_ID    1234        # Key Management TV ID
KEY_TV_ID         101         # Key TV ID from KGEN Tests to use the key
IV_SIZE           16          # IV Size provided before IV data

IV_DATA           16          # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32          # Plaintext size before Plaintext/Input data

INPUT_DATA        32          # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       16          # Ciphertext/Output size
CIPHER_ALGO       0x04404000  # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1D        # HSM_OUT_TOO_SMALL

TEST_CIPHER_END



#Negative Case:
#Invalid Input Size, not multiple of block size, block size 16 bytes for AES
TEST_CIPHER_PSA_N103

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         101        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        40         # Plaintext size before Plaintext/Input data

INPUT_DATA        40         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F,
0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_CIPHER_END



#Negative Case:
#Mismatched Permitted Algo, key not permitted for AES CBC algo
TEST_CIPHER_PSA_N104

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         102        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_CIPHER_END



#Negative Case:
#Incorrect Key Usage, only HSM_KEY_USAGE_DECRYPT (No ENCRYPT) in key usage
TEST_CIPHER_PSA_N105

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         103        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_CIPHER_END



#Negative Case:
#Asymmetric Key is used- Incorrect Key Type, Permitted Algo, Key Usage
#Key attributes are not valid to be used with Cipher Operations
TEST_CIPHER_PSA_N106

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         104        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_CIPHER_END



#Negative Case:
#Non-Existent Key ID, Invalid KEY_TV_ID for which no key has been generated/saved
TEST_CIPHER_PSA_N107

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         1011       # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x03       # HSM_UNKNOWN_ID

TEST_CIPHER_END



##########################################################################



CLOSE_KEY_MGMT_SRV
1234     #KEY_MGMT_TV_ID



TESTS_END
