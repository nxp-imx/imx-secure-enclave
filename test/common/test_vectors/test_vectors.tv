#########################################################################
#
# - The test vector filename with full PATH needs to be provided to
#   ele_hsm_test application with format: ele_hsm_test <tv_file_path>
#
# - Read test_add_instructions_tv.txt before for format description and the
#   steps to be followed while adding new test vectors for supported tests
#
# - This file contains Test vectors for ELE HSM API Tests.
#   Currently Supports test vectors for - KGEN, CIPHER,
#
#########################################################################


TESTS_START


OPEN_KEY_MGMT_SRV
1234             #Key Management ID, KEY_MGMT_TV_ID to be used by tests



#Positive Case
TEST_KGEN_PSA_001

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         1          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Postive Case
TEST_KGEN_PSA_002

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         2          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x1100     # HSM_KEY_TYPE_HMAC
BIT_KEY_SZ        256        # HSM_KEY_SIZE_HMAC_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03800009 # PERMITTED_ALGO_HMAC_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_003

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         3          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00004000 # HSM_KEY_USAGE_DERIVE
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Negative Case - Incorrect Key Lifetime value
TEST_KGEN_PSA_004

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         4          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000012 # Incorrect Value
KEY_USAGE         0x00004300 # HSM_KEY_USAGE_DERIVE | HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case - Incompatible Key Usage flags set, for HSM_KEY_TYPE_AES_256
TEST_KGEN_PSA_005

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         5          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case - Incompatible Key Usage flags set, for HSM_KEY_TYPE_AES_128
TEST_KGEN_PSA_006

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         6          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        128        # HSM_KEY_SIZE_AES_128
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case - Incorrect Permitted Algo
TEST_KGEN_PSA_007

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         7          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x01108888 # Incorrect Value
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case - Invalid Key Type
TEST_KGEN_PSA_008

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         8          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x99       # Non-Existent, Incorrect Key Type
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_KGEN_END



#Negative Case - Incorrect Key Group, for Symmetric Key
TEST_KGEN_PSA_009

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         9          # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1024       # Key Group OUT OF RANGE [0-1023]
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000C00 # HSM_KEY_USAGE_SIGN_MSG | HSM_KEY_USAGE_VERIFY_MSG
PERMITTED_ALGO    0x03C00200 # PERMITTED_ALGO_CMAC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case - Incorrect Key Usage, for Asymmetric Key
TEST_KGEN_PSA_010

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         10         # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00009000 # Non-Existent, Incorrect KEY USAGE value
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_KGEN_END



#Negative Case - Key Not Supported
TEST_KGEN_PSA_011

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         11         # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          80         # Public Key Out Size
KEY_TYPE          0x7130     # HSM_KEY_TYPE_ECC_BP_R1
BIT_KEY_SZ        320        # HSM_KEY_SIZE_ECC_BP_R1_320
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x06000608 # PERMITTED_ALGO_ECDSA_SHA224
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_KGEN_END




#KEY GENERATION Tests for generating keys which can be used in CIPHER TESTS


#Positive Case
TEST_KGEN_PSA_101

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         101        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x04404000 # PERMITTED_ALGO_CBC_NO_PADDING
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_102

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         102        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x04404400 # PERMITTED_ALGO_ECB_NO_PADDING
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_103

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         103        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000300 # HSM_KEY_USAGE_ENCRYPT | HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x84C0FF00 # PERMITTED_ALGO_ALL_CIPHER
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_104

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         104        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          0          # Symmetric Key. So, Public Key Out Size 0
KEY_TYPE          0x2400     # HSM_KEY_TYPE_AES
BIT_KEY_SZ        256        # HSM_KEY_SIZE_AES_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00000200 # HSM_KEY_USAGE_DECRYPT
PERMITTED_ALGO    0x04404000 # PERMITTED_ALGO_CBC_NO_PADDING
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END



#Positive Case
TEST_KGEN_PSA_105

KEY_MGMT_TV_ID    1234       # Key Management ID
KEY_TV_ID         105        # Key TV ID to use the key later
KEY_ID            0x0        # Key ID 0 for Volatile Key
OUT_SIZE          64         # Public Key Out Size
KEY_TYPE          0x7112     # HSM_KEY_TYPE_ECC_NIST
BIT_KEY_SZ        256        # HSM_KEY_SIZE_ECC_NIST_256
FLAGS             0          #
KEY_GROUP         1          # Key Group b/w 0-1023
KEY_LIFETIME      0x00000000 # HSM_SE_INTERN_STORAGE_VOLATILE
KEY_USAGE         0x00003000 # HSM_KEY_USAGE_SIGN_HASH | HSM_KEY_USAGE_VERIFY_HASH
PERMITTED_ALGO    0x06000609 # PERMITTED_ALGO_ECDSA_SHA256
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_KGEN_END




# CIPHER tests using Saved Generated Keys with KEY_TV_ID



#Positive Case:
#Test Cipher operation with AES CBC algo using saved Key permitted for AES CBC
TEST_CIPHER_PSA_101

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         101        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_CIPHER_END



#Positive Case:
#Test Cipher operation with AES ECB algo using saved Key permitted for AES ECB
TEST_CIPHER_PSA_102

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         102        # Key TV ID from KGEN Tests to use the key
IV_SIZE           0          # IV Size provided before IV data
IV_DATA           0          # IV data-IV size take input from next line
INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404400 # HSM_CIPHER_ONE_GO_ALGO_ECB
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_CIPHER_END



#Positive Case:
#Test Cipher operation with AES CBC using Key permitted for All (CBC, ECB)
TEST_CIPHER_PSA_103

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         103        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_CIPHER_END



#Positive Case:
#Test Cipher operation with AES ECB using Key permitted for All (CBC, ECB)
TEST_CIPHER_PSA_104

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         103        # Key TV ID from KGEN Tests to use the key
IV_SIZE           0          # IV Size provided before IV data
IV_DATA           0          # IV data-IV size, for 0 size, No buffer input
INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404400 # HSM_CIPHER_ONE_GO_ALGO_ECB
EXPECTED_HSM_RESP 0x00       # HSM_NO_ERROR

TEST_CIPHER_END



#Negative Case:
#Incorrect Key Usage, only HSM_KEY_USAGE_DECRYPT (No ENCRYPT) in key usage
TEST_CIPHER_PSA_105

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         104        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_CIPHER_END



#Negative Case:
#Mismatched Permitted Algo, key not permitted for AES CBC algo
TEST_CIPHER_PSA_106

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         102        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_CIPHER_END



#Negative Case:
#Asymmetric Key is used- Incorrect Key Type, Permitted Algo, Key Usage
#Key attributes are not valid to be used with Cipher Operations
TEST_CIPHER_PSA_107

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         105        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1B       # HSM_KEY_NOT_SUPPORTED

TEST_CIPHER_END



#Negative Case:
#Non-Existent Key ID, Invalid KEY_TV_ID for which no key has been generated/saved
TEST_CIPHER_PSA_108

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         1011       # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x03       # HSM_UNKNOWN_ID

TEST_CIPHER_END



#Negative Case:
#Invalid IV size instead of 16 bytes providing 32 bytes
TEST_CIPHER_PSA_109

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         101        # Key TV ID from KGEN Tests to use the key
IV_SIZE           32         # IV Size provided before IV data

IV_DATA           32         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32         # Plaintext size before Plaintext/Input data

INPUT_DATA        32         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_CIPHER_END



#Negative Case:
#Invalid Output Size instead of 32 bytes providing 16 bytes
TEST_CIPHER_PSA_110

KEY_MGMT_TV_ID    1234        # Key Management TV ID
KEY_TV_ID         101         # Key TV ID from KGEN Tests to use the key
IV_SIZE           16          # IV Size provided before IV data

IV_DATA           16          # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        32          # Plaintext size before Plaintext/Input data

INPUT_DATA        32          # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F

OUTPUT_SIZE       16          # Ciphertext/Output size
CIPHER_ALGO       0x04404000  # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x1D        # HSM_OUT_TOO_SMALL

TEST_CIPHER_END



#Negative Case:
#Invalid Input Size, not multiple of block size, block size 16 bytes for AES
TEST_CIPHER_PSA_111

KEY_MGMT_TV_ID    1234       # Key Management TV ID
KEY_TV_ID         101        # Key TV ID from KGEN Tests to use the key
IV_SIZE           16         # IV Size provided before IV data

IV_DATA           16         # IV data-IV size take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F

INPUT_SIZE        40         # Plaintext size before Plaintext/Input data

INPUT_DATA        40         # Plaintext size to take input from next line
0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F,
0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27

OUTPUT_SIZE       32         # Ciphertext/Output size
CIPHER_ALGO       0x04404000 # HSM_CIPHER_ONE_GO_ALGO_CBC
EXPECTED_HSM_RESP 0x04       # HSM_INVALID_PARAM

TEST_CIPHER_END



CLOSE_KEY_MGMT_SRV
1234     #KEY_MGMT_TV_ID


TESTS_END
